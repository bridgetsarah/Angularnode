angular.module("app",["ngRoute"]);var app=angular.module("app",[]);app.controller("PostsCtrl",["$scope","PostsSvc",function(o,t){o.addpost=function(){o.postBody&&t.create({username:"bridgetsarah",body:o.postBody}).success(function(t){o.posts.unshift(t),o.postBody=null})},t.fetch().success(function(t){o.posts=t}),app.service("PostsSvc",["$http",function(t){this.fetch=function(){return t.get("/api/posts")}}]),this.create=function(t){return $http.get(".api/posts",t)}}]),angular.module("app").controller("ApplicationCtrl",["$scope",function(n){n.$on("login",function(t,o){n.currentUser=o})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc","$location",function(n,e,s){n.login=function(t,o){e.login(t,o).then(function(t){n.$emit("login",t),s.path("/"),console.log(t)})}}]),angular.module("app").service("WebSocketSvc",["$rootScope",function(n){var e;this.connect=function(){(e=new WebSocket("ws://localhost:3000")).onmessage=function(t){var o=JSON.parse(t.data);n.$broadcast("ws:"+o.topic,o.data)}},this.send=function(t,o){var n=JSON.stringyify({topic:t,data:o});e.send(n)}}]).run(["WebSocketSvc",function(t){t.connect()}]).controller("postsCtrl",["$scope","PostsSvc",function(o,t){o.addPost=function(){o.postBody&&t.create({username:"bridgetsarah",body:o.postBody}).success(function(t){o.postBody=null})}}]),$scope.$on("ws:new_post",function(t,o){$scope.$apply(function(){$scope.posts.unshift(o)})}),PostsSvc.fetch().success(function(t){$scope.posts=t}),angular.module("app").service("PostsSvc",["$http",function(o){this.fetch=function(){return o.get("/api/posts")},this.create=function(t){return o.post("/api/posts",t)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc","$location",function(n,e,s){n.register=function(t,o){e.register(t,o).then(function(t){n.$emit("login",t),s.path("/")})}}]),angular.module("app").config(["$routeProvider",function(t){t.when("/",{controller:"Postsctrl",templateUrl:"posts.html"}).when("/register",{controller:"registerCtrl",templateUrl:"register.html"}).when("login",{controller:"LoginCtrl",templateUrl:"login.html"})}]),angular.module("app").service("UserSvc",["$http",function(n){var e=this;e.getUser=function(){return n.get("/api/users").then(function(t){return t.data})},e.login=function(t,o){return n.post("/api/sessions",{username:t,password:o}).then(function(t){return e.token=response.data,n.defaults.header.common["X-Auth"]=response.data,e.getUser()})}}]),svc.register=function(t,o){return $http.post("/api/users",{username:t,password:o}).then(function(){return svc.login(t,o)})},angular.mdoule("app").run(function(t){new WebSocket("ws://localhost:3000").onopen=function(){console.log("WebSocket connected")}}),connection.onmessage=function(t){console.log(t);var o=JSON.parse(t.data);$rootScope.$broadcast("ws:"+o.topic,o.data)};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcC5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyIsIndlYnNvY2tldHMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImFwcCIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCJQb3N0c1N2YyIsImFkZHBvc3QiLCJwb3N0Qm9keSIsImNyZWF0ZSIsInVzZXJuYW1lIiwiYm9keSIsInN1Y2Nlc3MiLCJwb3N0IiwicG9zdHMiLCJ1bnNoaWZ0IiwiZmV0Y2giLCJzZXJ2aWNlIiwiJGh0dHAiLCJ0aGlzIiwiZ2V0IiwiJG9uIiwiXyIsInVzZXIiLCJjdXJyZW50VXNlciIsIlVzZXJTdmMiLCIkbG9jYXRpb24iLCJsb2dpbiIsInBhc3N3b3JkIiwidGhlbiIsIiRlbWl0IiwicGF0aCIsImNvbnNvbGUiLCJsb2ciLCIkcm9vdFNjb3BlIiwiY29ubmVjdGlvbiIsImNvbm5lY3QiLCJXZWJTb2NrZXQiLCJvbm1lc3NhZ2UiLCJlIiwicGF5bG9hZCIsIkpTT04iLCJwYXJzZSIsImRhdGEiLCIkYnJvYWRjYXN0IiwidG9waWMiLCJzZW5kIiwianNvbiIsInN0cmluZ3lpZnkiLCJydW4iLCJXZWJTb2NrZXRTdmMiLCJhZGRQb3N0IiwiJGFwcGx5IiwicmVnaXN0ZXIiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsInN2YyIsImdldFVzZXIiLCJyZXNwb25zZSIsInZhbCIsInRva2VuIiwiZGVmYXVsdHMiLCJoZWFkZXIiLCJjb21tb24iLCJtZG91bGUiLCJvbm9wZW4iXSwibWFwcGluZ3MiOiJBQUVBQSxRQUFBQyxPQUFBLE1BQUEsQ0FDQSxZQURBLElBQUFDLElBQUFGLFFBQUFDLE9BQUEsTUFBQSxJQ0lBQyxJQUFBQyxXQUFBLFlBQUEs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QUEsVUFBQSxDQUFBLFFBQUEsU0FBQUMsR0FDQSxJQUFBd0MsRUFBQXZDLEtBQ0F1QyxFQUFBQyxRQUFBLFdBQ0EsT0FBQXpDLEVBQUFFLElBQUEsY0FDQVMsS0FBQSxTQUFBK0IsR0FDQSxPQUFBQSxFQUFBakIsUUFHQWUsRUFBQS9CLE1BQUEsU0FBQWpCLEVBQUFrQixHQUNBLE9BQUFWLEVBQUFMLEtBQUEsZ0JBQUEsQ0FDQUgsU0FBQUEsRUFBQWtCLFNBQUFBLElBQ0FDLEtBQUEsU0FBQWdDLEdBR0EsT0FGQUgsRUFBQUksTUFBQUYsU0FBQWpCLEtBQ0F6QixFQUFBNkMsU0FBQUMsT0FBQUMsT0FBQSxVQUFBTCxTQUFBakIsS0FDQWUsRUFBQUMsZ0JBS0FELElBQUFMLFNBQUEsU0FBQTNDLEVBQUFrQixHQUNBLE9BQUFWLE1BQUFMLEtBQUEsYUFBQSxDQUNBSCxTQUFBQSxFQUFBa0IsU0FBQUEsSUFDQUMsS0FBQSxXQUNBLE9BQUE2QixJQUFBL0IsTUFBQWpCLEVBQUFrQixNQ3JCQTNCLFFBQUFpRSxPQUFBLE9BQ0FqQixJQUFBLFNBQUFmLEdBRUEsSUFBQUcsVUFEQSx1QkFHQThCLE9BQUEsV0FDQW5DLFFBQUFDLElBQUEsMEJBS0FFLFdBQUFHLFVBQUEsU0FBQUMsR0FDQVAsUUFBQUMsSUFBQU0sR0FDQSxJQUFBQyxFQUFBQyxLQUFBQyxNQUFBSCxFQUFBSSxNQUNBVCxXQUFBVSxXQUFBLE1BQUFKLEVBQUFLLE1BQUFMLEVBQUFHIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGFwaS9uZy9tb2R1bGUuanNcblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcbiAgICAnbmdSb3V0ZSdcbl0pIiwiLy8gYXBpL25nL2FwcC5qc1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtdKVxuXG4gICAgLy8gUG9zdHNDb250cm9sbGVyIE1vZHVsZSAmIERlcGVuZGVuY3kgSW5qZWN0IFNjb3BlXG5cbiAgICAgYXBwLmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFBvc3RzU3ZjKSB7XG4gICAgICAgICRzY29wZS5hZGRwb3N0ID0gZnVuY3Rpb24gKCkgeyAgICAgICAgICAgICAgICAgIC8vIHRoZSBmdW5jdGlvbiBydW5zIHdoZW4gdGhlIFwiYWRkIHBvc3RcIiBidXR0b24gaXMgY2xpY2tlZCAgIFxuICAgICAgICAgaWYgKCRzY29wZS5wb3N0Qm9keSkge1xuICAgICAgICAgICAgIFBvc3RzU3ZjLmNyZWF0ZSh7ICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgdXNlcm5hbWU6ICdicmlkZ2V0c2FyYWgnLFxuICAgICAgICAgICAgICBib2R5OiAkc2NvcGUucG9zdEJvZHlcbiAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uIChwb3N0KXtcbiAgICAgICAgICAgICAgJHNjb3BlLnBvc3RzLnVuc2hpZnQocG9zdClcbiAgICAgICAgICAgICAgJHNjb3BlLnBvc3RCb2R5ID0gbnVsbFxuICAgICAgICAgIH0pXG4gICAgICAgICB9XG4gICAgICAgIH1cbi8vIG5ldyBQb3N0cyBTVkMgc2VjdGlvblxuICAgIFBvc3RzU3ZjLmZldGNoKCkuc3VjY2VzcyhmdW5jdGlvbiAocG9zdHMpIHtcbiAgICAkc2NvcGUucG9zdHMgPSBwb3N0cyAgICBcbn0pXG5cblxuLy9EZWZpbmluZyBzZXJ2aWNlIG9uIGFwcCBiZWxvd1xuICAgIGFwcC5zZXJ2aWNlKCdQb3N0c1N2YycsIGZ1bmN0aW9uICgkaHR0cCkge1xuICAgICAgICB0aGlzLmZldGNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9wb3N0cycpXG4gICAgICAgIH1cbiAgICB9KSAgICBcbiAgICB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uIChwb3N0KSB7XG4gICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy5hcGkvcG9zdHMnLHBvc3QpXG4gICAgfVxufSlcbiIsIi8vIGFwaS9uZy9hcHBsaWNhdGlvbi5jdHJsLmpzXG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUpIHtcbiAgICAkc2NvcGUuJG9uKCdsb2dpbicsIGZ1bmN0aW9uIChfLCB1c2VyKXtcbiAgICAgICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlclxuICAgIH0pXG59KSIsIi8vIGFwaS9uZy9sb2dpbiBjb250cm9sbGVyXG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjLCAkbG9jYXRpb24pe1xuICAgICAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICAgICAgICBVc2VyU3ZjLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZClcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh1c2VyKXtcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGVtaXQoJ2xvZ2luJywgdXNlcilcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codXNlcilcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4vLyBBZGRlZCBXZWJzb2NrZXQgZnVuY3Rpb25cbi5zZXJ2aWNlKCdXZWJTb2NrZXRTdmMnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSl7XG4gICAgdmFyIGNvbm5lY3Rpb25cbiAgICB0aGlzLmNvbm5lY3QgPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgdmFyIHVybCA9ICd3czovL2xvY2FsaG9zdDozMDAwJ1xuICAgICAgICBjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldCh1cmwpXG4gICAgICAgIGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpe1xuICAgICAgICAgICAgdmFyIHBheWxvYWQgPSBKU09OLnBhcnNlKGUuZGF0YSlcbiAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudG9waWMsIHBheWxvYWQuZGF0YSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIHRoaXMuc2VuZCA9IGZ1bmN0aW9uICh0b3BpYywgZGF0YSkge1xuICAgICAgICB2YXIganNvbiA9IEpTT04uc3RyaW5neWlmeSh7dG9waWM6IHRvcGljLCBkYXRhOiBkYXRhfSlcbiAgICAgICAgY29ubmVjdGlvbi5zZW5kKGpzb24pXG4gICAgfVxufSkucnVuKGZ1bmN0aW9uIChXZWJTb2NrZXRTdmMpe1xuICAgIFdlYlNvY2tldFN2Yy5jb25uZWN0KClcbn0pXG5cblxuLmNvbnRyb2xsZXIoJ3Bvc3RzQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFBvc3RzU3ZjKXtcbiAgICAkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCRzY29wZS5wb3N0Qm9keSkge1xuICAgICAgICAgICAgUG9zdHNTdmMuY3JlYXRlKHtcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogJ2JyaWRnZXRzYXJhaCcsXG4gICAgICAgICAgICAgICAgYm9keTogJHNjb3BlLnBvc3RCb2R5XG4gICAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uIChwb3N0KXtcbiAgICAgICAgICAgICAgICAkc2NvcGUucG9zdEJvZHkgPSBudWxsXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxufSlcbi8vIHdlYnNvY2tldHMgcG9zdCB3cyBmdW5jdGlvbiAtIHAxMzQgLSByZW1vdmUgdW5zaGlmdCBmdW5jdGlvbiBpZiBwb3N0cyBhcHBlYXIgdHdpY2UhIVxuJHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbiAoXywgcG9zdCl7XG4gICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKXtcbiAgICAgICAgJHNjb3BlLnBvc3RzLnVuc2hpZnQocG9zdClcbiAgICB9KVxufSlcblxuUG9zdHNTdmMuZmV0Y2goKS5zdWNjZXNzKGZ1bmN0aW9uIChwb3N0cyl7XG4gICAgJHNjb3BlLnBvc3RzID0gcG9zdHNcbiAgfSlcbiAgIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnUG9zdHNTdmMnLCBmdW5jdGlvbiAoJGh0dHApe1xuICAgIHRoaXMuZmV0Y2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnKVxuICAgIH1cbiAgICB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uIChwb3N0KXtcbiAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcG9zdHMnLCBwb3N0KVxuICAgIH1cbn0pIiwiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjLCAkbG9jYXRpb24pIHtcbiAgJHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgIFVzZXJTdmMucmVnaXN0ZXIodXNlcm5hbWUsIHBhc3N3b3JkKVxuICAgIC50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAkc2NvcGUuJGVtaXQoJ2xvZ2luJywgdXNlcilcbiAgICAgICRsb2NhdGlvbi5wYXRoKCcvJylcbiAgICB9KVxuICB9XG59KSIsIi8vZGVmaW5pbmcgcm91dGVzIGZvciBwb3N0cyBwYWdlLCByZWdpc3RlciBwYWdlLCBhbmQgbG9naW4gcGFnZVxuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKXtcbiAgICAkcm91dGVQcm92aWRlclxuICAgIC53aGVuKCcvJywgeyBjb250cm9sbGVyOiAnUG9zdHNjdHJsJywgdGVtcGxhdGVVcmw6ICdwb3N0cy5odG1sJyB9KVxuICAgIC53aGVuKCcvcmVnaXN0ZXInLCB7Y29udHJvbGxlcjogJ3JlZ2lzdGVyQ3RybCcsIHRlbXBsYXRlVXJsOiAncmVnaXN0ZXIuaHRtbCcgfSlcbiAgICAud2hlbignbG9naW4nLCB7Y29udHJvbGxlcjogJ0xvZ2luQ3RybCcsIHRlbXBsYXRlVXJsOiAnbG9naW4uaHRtbCcgfSlcbn0pIiwiLy8gQXBpL25nL3VzZXIuc3ZjLmpzIGZpbGVcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1VzZXJTdmMnLCBmdW5jdGlvbigkaHR0cCl7ICAgIC8vL1VzZXIgU2VydmljZVxuICAgIHZhciBzdmMgPSB0aGlzXG4gICAgc3ZjLmdldFVzZXIgPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSl7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YVxuICAgICAgICB9KVxuICAgIH1cbnN2Yy5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpeyAgLy8gTG9naW4gc2VydmljZXNcbiAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucycsIHtcbiAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLCBwYXNzd29yZDogcGFzc3dvcmRcbiAgICB9KS50aGVuKGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgc3ZjLnRva2VuID0gcmVzcG9uc2UuZGF0YVxuICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXIuY29tbW9uWydYLUF1dGgnXSA9IHJlc3BvbnNlLmRhdGFcbiAgICAgICAgcmV0dXJuIHN2Yy5nZXRVc2VyKClcbiAgICB9KVxuICB9XG59KVxuXG5zdmMucmVnaXN0ZXIgPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XG4gICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgfSkudGhlbihmdW5jdGlvbiAoKXtcbiAgICAgICAgcmV0dXJuIHN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgfSlcbn1cbiIsIi8vIGFwaS9uZy93ZWJzb2NrZXRzLmpzXG5cblxuLy9Bbmd1bGFyIHJ1biBjb21tcG9uZW50IGZvciB3ZWJzb2NrZXRzXG5hbmd1bGFyLm1kb3VsZSgnYXBwJylcbi5ydW4oZnVuY3Rpb24gKCRyb290U2NvcGUpe1xuICAgIHZhciB1cmwgPSAnd3M6Ly9sb2NhbGhvc3Q6MzAwMCdcbiAgICB2YXIgY29ubmVjdGlvbiA9IG5ldyBXZWJTb2NrZXQodXJsKVxuXG4gICAgY29ubmVjdGlvbi5vbm9wZW4gPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgY29uc29sZS5sb2coJ1dlYlNvY2tldCBjb25uZWN0ZWQnKVxuICAgIH1cbn0pXG5cbi8vIHdlYiBzb2NrZXQgZXZlbnQgaGFuZGxpbmcgbWVzc2FnZSAoaWYgb2theSEhKVxuY29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZSl7XG4gICAgY29uc29sZS5sb2coZSlcbiAgICB2YXIgcGF5bG9hZCA9IEpTT04ucGFyc2UoZS5kYXRhKVxuICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudG9waWMsIHBheWxvYWQuZGF0YSlcbn0iXX0=
