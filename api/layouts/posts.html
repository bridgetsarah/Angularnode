<!doctype HTML> 
<html> <!-- POSTS FILE INSIDE LAYOUTS FOLDER!!!-->
    <head>
    <title> Hello World Mean Application</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css">
    </head>
    <body ng-app='app'>
     <div ng-controller='PostsCtrl' class='Container'>
    <h1>Recent Posts</h1>
     <!-- form-->
        <form role='form'>
        <div class='form-group'>
        <div class='input-group'> 
        <input ng-model='postbody' class='form-control' />
        <span class='input-group-btn'>
            <button ng-click='add post()' class='btn btn-default'>Add Posts</button>   
        </span>
        </div>
        </div>
        </form>
    <!-- list group items-->
         <ul class='list-group'>
        <li ng-repeat="posts in posts | orderBy:'-date'" class='list-group-item'>
            <strong>@{{ post.username}}</strong>
            <span>{{ post.body }}</span>
        </li>
        </ul>
        </div>
    <!-- Angular & Library-->
    <script src='https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js'></script>
    <script>
    // create app module
    var app = angular.module('app', [])

    // PostsController Module & Dependency Inject Scope

     app.controller('PostsCtrl', function ($scope, $http) {
        
    
        $scope.addpost = function () {                  // the function runs when the "add post" button is clicked   
         if ($scope.postBody) {                         // only add a post if there is a body                      
          $http.post('/api/posts'){
              username: 'bridgetsarah',
              body: $scope.postBody
          }).success(function (post){
              $scope.posts.unshift(post)
              $scope.postBody = null
          })
         }
        }
        // New $HTTP scope posts section               ----------------------------------------------------                                         
        $http.get('http://localhost:3000/api/posts')
        .success(function (posts){
            $scope.posts = posts
        })
    </script>   
    </body>
</html>